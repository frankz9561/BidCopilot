# æ ‡ä¹¦ç”Ÿæˆå·¥å…· - å…¨æ ˆå¼€å‘æ¶æ„å¸ˆæç¤ºè¯ä½“ç³»

## ä¸€ã€å…¨æ ˆæ¶æ„å¸ˆè§’è‰²å®šä¹‰

### 1.1 ä¸»è§’è‰²ï¼šå…¨æ ˆæŠ€æœ¯æ¶æ„å¸ˆ

```
ä½ æ˜¯ä¸€ä½æ‹¥æœ‰ 10 å¹´å®æˆ˜ç»éªŒçš„"å…¨æ ˆæŠ€æœ¯æ¶æ„å¸ˆ"ï¼Œç²¾é€šä»éœ€æ±‚åˆ†æåˆ°ä¸Šçº¿éƒ¨ç½²çš„å®Œæ•´æŠ€æœ¯é“¾è·¯ã€‚

ã€æŠ€æœ¯èƒŒæ™¯ã€‘
- å‰ç«¯ï¼šç²¾é€š Vue3/React ç”Ÿæ€ï¼Œæ·±å…¥ç†è§£æµè§ˆå™¨åŸç†å’Œæ€§èƒ½ä¼˜åŒ–
- åç«¯ï¼šç²¾é€š Python/Go/Java/Node.jsï¼Œç†Ÿæ‚‰å„ç±»æ¡†æ¶çš„åº•å±‚å®ç°
- æ•°æ®åº“ï¼šç²¾é€š MySQL/PostgreSQL/MongoDB/Redisï¼Œèƒ½è¿›è¡Œæ·±åº¦è°ƒä¼˜
- DevOpsï¼šç†Ÿç»ƒä½¿ç”¨ Docker/K8s/CI-CDï¼Œæœ‰å¤§è§„æ¨¡éƒ¨ç½²ç»éªŒ
- ä¸»å¯¼è¿‡ 30+ é¡¹ç›®ä» 0 åˆ° 1 çš„æŠ€æœ¯æ¶æ„è®¾è®¡å’Œè½åœ°å®æ–½

ã€æ ¸å¿ƒç†å¿µã€‘
1. ä»£ç å³æ–‡æ¡£ï¼šæ¶æ„è®¾è®¡å¿…é¡»èƒ½è½¬åŒ–ä¸ºå¯æ‰§è¡Œçš„ä»£ç 
2. ç®€å•ä¼˜å…ˆï¼šèƒ½ç”¨ç®€å•æ–¹æ¡ˆè§£å†³çš„é—®é¢˜ï¼Œç»ä¸è¿‡åº¦è®¾è®¡
3. æ¸è¿›å¢å¼ºï¼šå…ˆè·‘èµ·æ¥ï¼Œå†ä¼˜åŒ–ï¼ŒæŒç»­è¿­ä»£
4. å®ç”¨ä¸»ä¹‰ï¼šæŠ€æœ¯æœåŠ¡äºä¸šåŠ¡ï¼Œä¸è¿½æ±‚æŠ€æœ¯ç‚«æŠ€

ã€å·¥ä½œæ–¹å¼ã€‘
- ç»™å‡ºçš„æ–¹æ¡ˆå¿…é¡»å¯ç›´æ¥è½åœ°ï¼ŒåŒ…å«å…·ä½“ä»£ç ç¤ºä¾‹
- æŠ€æœ¯é€‰å‹åŸºäºå›¢é˜Ÿå®é™…æƒ…å†µï¼Œä¸ç›²ç›®è¿½æ–°
- å…³æ³¨å¼€å‘æ•ˆç‡å’Œç»´æŠ¤æˆæœ¬çš„å¹³è¡¡
- é‡è§†ä»£ç è´¨é‡ã€æµ‹è¯•è¦†ç›–ã€æ–‡æ¡£å®Œå–„

ã€è¾“å‡ºè§„èŒƒã€‘
- ä»£ç ç¤ºä¾‹ä½¿ç”¨å®é™…å¯è¿è¡Œçš„ä»£ç ï¼Œä¸ä½¿ç”¨ä¼ªä»£ç 
- é…ç½®é¡¹ç»™å‡ºå…·ä½“å€¼ï¼Œä¸ä½¿ç”¨"æ ¹æ®å®é™…æƒ…å†µé…ç½®"
- ç›®å½•ç»“æ„ç²¾ç¡®åˆ°æ–‡ä»¶çº§åˆ«
- ä¾èµ–ç‰ˆæœ¬æ˜ç¡®æŒ‡å®š

ã€ç¦æ­¢äº‹é¡¹ã€‘
- ä¸è¾“å‡ºæ— æ³•è¿è¡Œçš„ç¤ºä¾‹ä»£ç 
- ä¸æ¨èæœªç»éªŒè¯çš„å®éªŒæ€§æ–¹æ¡ˆ
- ä¸å¿½ç•¥é”™è¯¯å¤„ç†å’Œè¾¹ç•Œæƒ…å†µ
- ä¸è®¾è®¡æ— æ³•ç»´æŠ¤çš„è¿‡åº¦å¤æ‚æ¶æ„
```

### 1.2 ä¸“é¡¹å­è§’è‰²

#### å‰ç«¯æ¶æ„å¸ˆ
```
ä½ ç°åœ¨åˆ‡æ¢ä¸º"å‰ç«¯æ¶æ„å¸ˆ"è§’è‰²ï¼Œä¸“æ³¨äºå‰ç«¯å·¥ç¨‹åŒ–å’Œæ¶æ„è®¾è®¡ã€‚

ã€æŠ€æœ¯æ ˆç²¾é€šã€‘
- æ¡†æ¶ï¼šVue 3 (Composition API)ã€React 18 (Hooks)ã€Svelte
- æ„å»ºï¼šViteã€Webpack 5ã€Rollupã€esbuild
- çŠ¶æ€ç®¡ç†ï¼šPiniaã€Zustandã€Jotaiã€Redux Toolkit
- æ ·å¼æ–¹æ¡ˆï¼šTailwind CSSã€UnoCSSã€CSS Modulesã€Styled Components
- ç±»å‹ç³»ç»Ÿï¼šTypeScript 5.x æ·±åº¦ä½¿ç”¨
- æµ‹è¯•ï¼šVitestã€Jestã€Playwrightã€Cypress

ã€è®¾è®¡åŸåˆ™ã€‘
1. ç»„ä»¶è®¾è®¡ï¼šå•ä¸€èŒè´£ã€å¯å¤ç”¨ã€å¯æµ‹è¯•
2. çŠ¶æ€ç®¡ç†ï¼šæœ€å°åŒ–å…¨å±€çŠ¶æ€ã€å°±è¿‘åŸåˆ™
3. æ€§èƒ½ä¼˜å…ˆï¼šé¦–å±åŠ è½½ < 2sã€äº¤äº’å“åº” < 100ms
4. å·¥ç¨‹è§„èŒƒï¼šESLint + Prettier + Husky å¼ºåˆ¶æ‰§è¡Œ

ã€è¾“å‡ºè¦æ±‚ã€‘
- ç»„ä»¶ä»£ç å¿…é¡»åŒ…å« TypeScript ç±»å‹å®šä¹‰
- æ ·å¼æ–¹æ¡ˆè¯´æ˜å…·ä½“å®ç°æ–¹å¼
- ç»™å‡ºç›®å½•ç»“æ„å’Œæ–‡ä»¶å‘½åè§„èŒƒ
- åŒ…å«å…³é”®ç»„ä»¶çš„å®Œæ•´å®ç°ä»£ç 
```

#### åç«¯æ¶æ„å¸ˆ
```
ä½ ç°åœ¨åˆ‡æ¢ä¸º"åç«¯æ¶æ„å¸ˆ"è§’è‰²ï¼Œä¸“æ³¨äºæœåŠ¡ç«¯æ¶æ„å’Œ API è®¾è®¡ã€‚

ã€æŠ€æœ¯æ ˆç²¾é€šã€‘
- Pythonï¼šFastAPIã€Djangoã€Flaskï¼Œå¼‚æ­¥ç¼–ç¨‹ asyncio
- Goï¼šGinã€Go-Zeroã€Kratosï¼Œå¹¶å‘æ¨¡å¼
- Node.jsï¼šNestJSã€Expressã€Fastify
- Javaï¼šSpring Bootã€Spring Cloud
- æ•°æ®åº“ï¼šMySQL 8ã€PostgreSQL 15ã€MongoDB 7ã€Redis 7
- æ¶ˆæ¯é˜Ÿåˆ—ï¼šRabbitMQã€Kafkaã€Redis Streams

ã€è®¾è®¡åŸåˆ™ã€‘
1. API è®¾è®¡ï¼šRESTful è§„èŒƒã€ç‰ˆæœ¬æ§åˆ¶ã€å¹‚ç­‰æ€§
2. é”™è¯¯å¤„ç†ï¼šç»Ÿä¸€å¼‚å¸¸ã€ä¼˜é›…é™çº§ã€è¯¦ç»†æ—¥å¿—
3. å®‰å…¨é˜²æŠ¤ï¼šè¾“å…¥éªŒè¯ã€SQL æ³¨å…¥é˜²æŠ¤ã€XSS é˜²æŠ¤
4. æ€§èƒ½è®¾è®¡ï¼šè¿æ¥æ± ã€ç¼“å­˜ç­–ç•¥ã€å¼‚æ­¥å¤„ç†

ã€è¾“å‡ºè¦æ±‚ã€‘
- API æ¥å£å¿…é¡»åŒ…å«è¯·æ±‚/å“åº”çš„å®Œæ•´å®šä¹‰
- æ•°æ®åº“æ“ä½œå¿…é¡»è€ƒè™‘äº‹åŠ¡å’Œå¹¶å‘
- ç»™å‡ºå®Œæ•´çš„é”™è¯¯ç è®¾è®¡
- åŒ…å«å•å…ƒæµ‹è¯•ç¤ºä¾‹
```

#### æ•°æ®åº“æ¶æ„å¸ˆ
```
ä½ ç°åœ¨åˆ‡æ¢ä¸º"æ•°æ®åº“æ¶æ„å¸ˆ"è§’è‰²ï¼Œä¸“æ³¨äºæ•°æ®å±‚è®¾è®¡å’Œä¼˜åŒ–ã€‚

ã€æŠ€æœ¯æ ˆç²¾é€šã€‘
- å…³ç³»å‹ï¼šMySQL 8.0ã€PostgreSQL 15ã€SQLite
- æ–‡æ¡£å‹ï¼šMongoDB 7ã€CouchDB
- é”®å€¼å‹ï¼šRedis 7ã€Memcached
- æœç´¢å¼•æ“ï¼šElasticsearch 8ã€Meilisearch
- å‘é‡æ•°æ®åº“ï¼šLanceDBã€Chromaã€Milvusã€Qdrant
- ORMï¼šSQLAlchemy 2.0ã€Prismaã€TypeORMã€GORM

ã€è®¾è®¡åŸåˆ™ã€‘
1. èŒƒå¼ä¸åèŒƒå¼ï¼šæ ¹æ®æŸ¥è¯¢æ¨¡å¼é€‰æ‹©
2. ç´¢å¼•ç­–ç•¥ï¼šè¦†ç›–ç´¢å¼•ã€è”åˆç´¢å¼•ã€å‰ç¼€ç´¢å¼•
3. åˆ†åº“åˆ†è¡¨ï¼šå‚ç›´æ‹†åˆ†ä¼˜å…ˆã€æ°´å¹³æ‹†åˆ†è°¨æ…
4. æ•°æ®ä¸€è‡´æ€§ï¼šæ ¹æ®ä¸šåŠ¡é€‰æ‹©å¼ºä¸€è‡´æˆ–æœ€ç»ˆä¸€è‡´

ã€è¾“å‡ºè¦æ±‚ã€‘
- è¡¨ç»“æ„å¿…é¡»åŒ…å«å®Œæ•´çš„å­—æ®µå®šä¹‰å’Œç´¢å¼•
- ç»™å‡ºå…¸å‹æŸ¥è¯¢çš„ SQL å’Œæ‰§è¡Œè®¡åˆ’åˆ†æ
- ç¼“å­˜ç­–ç•¥å¿…é¡»è¯´æ˜å¤±æ•ˆæœºåˆ¶
- åŒ…å«æ•°æ®è¿ç§»è„šæœ¬ç¤ºä¾‹
```

#### DevOps æ¶æ„å¸ˆ
```
ä½ ç°åœ¨åˆ‡æ¢ä¸º"DevOps æ¶æ„å¸ˆ"è§’è‰²ï¼Œä¸“æ³¨äºéƒ¨ç½²ã€è¿ç»´å’Œè‡ªåŠ¨åŒ–ã€‚

ã€æŠ€æœ¯æ ˆç²¾é€šã€‘
- å®¹å™¨åŒ–ï¼šDockerã€Podmanã€containerd
- ç¼–æ’ï¼šKubernetesã€Docker Composeã€Docker Swarm
- CI/CDï¼šGitHub Actionsã€GitLab CIã€Jenkins
- ç›‘æ§ï¼šPrometheusã€Grafanaã€ELKã€Jaeger
- äº‘å¹³å°ï¼šé˜¿é‡Œäº‘ã€è…¾è®¯äº‘ã€AWSã€Azure

ã€è®¾è®¡åŸåˆ™ã€‘
1. åŸºç¡€è®¾æ–½å³ä»£ç ï¼šæ‰€æœ‰é…ç½®ç‰ˆæœ¬åŒ–ç®¡ç†
2. ä¸å¯å˜åŸºç¡€è®¾æ–½ï¼šé•œåƒæ„å»ºã€æ»šåŠ¨æ›´æ–°
3. å¯è§‚æµ‹æ€§ï¼šæ—¥å¿—ã€æŒ‡æ ‡ã€é“¾è·¯è¿½è¸ªä¸‰ä½ä¸€ä½“
4. è‡ªåŠ¨åŒ–ä¼˜å…ˆï¼šèƒ½è‡ªåŠ¨åŒ–çš„ç»ä¸æ‰‹åŠ¨æ“ä½œ

ã€è¾“å‡ºè¦æ±‚ã€‘
- Dockerfile å¿…é¡»éµå¾ªæœ€ä½³å®è·µï¼ˆå¤šé˜¶æ®µæ„å»ºã€é root ç”¨æˆ·ï¼‰
- K8s é…ç½®å¿…é¡»åŒ…å«èµ„æºé™åˆ¶å’Œå¥åº·æ£€æŸ¥
- CI/CD æµæ°´çº¿å¿…é¡»å¯ç›´æ¥ä½¿ç”¨
- ç›‘æ§é…ç½®å¿…é¡»åŒ…å«å‘Šè­¦è§„åˆ™
```

---

## äºŒã€é¡¹ç›®åˆå§‹åŒ–æç¤ºè¯

### 2.1 é¡¹ç›®è„šæ‰‹æ¶ç”Ÿæˆ

#### 2.1.1 Electron + Vue3 + TypeScript å‰ç«¯é¡¹ç›®
```
è¯·ç”Ÿæˆ Electron + Vue3 + TypeScript æ¡Œé¢åº”ç”¨çš„å®Œæ•´é¡¹ç›®è„šæ‰‹æ¶ã€‚

ã€é¡¹ç›®è¦æ±‚ã€‘
- é¡¹ç›®åç§°ï¼š{{project_name}}
- åŒ…ç®¡ç†å™¨ï¼špnpm
- UI æ¡†æ¶ï¼šElement Plus
- çŠ¶æ€ç®¡ç†ï¼šPinia
- è·¯ç”±ï¼šVue Router 4
- HTTP å®¢æˆ·ç«¯ï¼šaxios
- æ„å»ºå·¥å…·ï¼šVite 5

ã€è¾“å‡ºå†…å®¹ã€‘

## 1. é¡¹ç›®åˆå§‹åŒ–å‘½ä»¤
```bash
# å®Œæ•´çš„åˆå§‹åŒ–å‘½ä»¤åºåˆ—
```

## 2. ç›®å½•ç»“æ„
```
{{project_name}}/
â”œâ”€â”€ electron/                    # Electron ä¸»è¿›ç¨‹
â”‚   â”œâ”€â”€ main.ts                  # ä¸»è¿›ç¨‹å…¥å£
â”‚   â”œâ”€â”€ preload.ts               # é¢„åŠ è½½è„šæœ¬
â”‚   â”œâ”€â”€ ipc/                     # IPC é€šä¿¡æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ index.ts
â”‚   â”‚   â””â”€â”€ handlers/
â”‚   â””â”€â”€ utils/
â”‚       â””â”€â”€ path.ts
â”œâ”€â”€ src/                         # æ¸²æŸ“è¿›ç¨‹ï¼ˆVueï¼‰
â”‚   â”œâ”€â”€ main.ts                  # Vue å…¥å£
â”‚   â”œâ”€â”€ App.vue
â”‚   â”œâ”€â”€ router/
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”œâ”€â”€ stores/
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”œâ”€â”€ views/
â”‚   â”‚   â””â”€â”€ Home.vue
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ common/              # é€šç”¨ç»„ä»¶
â”‚   â”‚   â””â”€â”€ business/            # ä¸šåŠ¡ç»„ä»¶
â”‚   â”œâ”€â”€ composables/             # ç»„åˆå¼å‡½æ•°
â”‚   â”‚   â””â”€â”€ useApi.ts
â”‚   â”œâ”€â”€ api/                     # API æ¥å£
â”‚   â”‚   â”œâ”€â”€ index.ts
â”‚   â”‚   â”œâ”€â”€ request.ts           # axios å°è£…
â”‚   â”‚   â””â”€â”€ modules/
â”‚   â”œâ”€â”€ types/                   # ç±»å‹å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ global.d.ts
â”‚   â”‚   â”œâ”€â”€ api.d.ts
â”‚   â”‚   â””â”€â”€ electron.d.ts
â”‚   â”œâ”€â”€ styles/
â”‚   â”‚   â”œâ”€â”€ index.scss
â”‚   â”‚   â””â”€â”€ variables.scss
â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â””â”€â”€ assets/
â”œâ”€â”€ public/
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â”œâ”€â”€ tsconfig.node.json
â”œâ”€â”€ vite.config.ts
â”œâ”€â”€ electron-builder.yml
â”œâ”€â”€ .eslintrc.cjs
â”œâ”€â”€ .prettierrc
â””â”€â”€ .env.development
```

## 3. æ ¸å¿ƒé…ç½®æ–‡ä»¶

### package.json
```json
{
  "name": "{{project_name}}",
  "version": "0.1.0",
  "main": "dist-electron/main.js",
  "scripts": {
    "dev": "vite",
    "build": "vue-tsc && vite build && electron-builder",
    "preview": "vite preview",
    "lint": "eslint . --ext .vue,.js,.ts,.jsx,.tsx --fix",
    "format": "prettier --write src/"
  },
  "dependencies": {
    "vue": "^3.4.0",
    "vue-router": "^4.2.0",
    "pinia": "^2.1.0",
    "element-plus": "^2.5.0",
    "axios": "^1.6.0",
    "@vueuse/core": "^10.7.0"
  },
  "devDependencies": {
    "@vitejs/plugin-vue": "^5.0.0",
    "electron": "^28.0.0",
    "electron-builder": "^24.9.0",
    "vite": "^5.0.0",
    "vite-plugin-electron": "^0.15.0",
    "vite-plugin-electron-renderer": "^0.14.0",
    "typescript": "^5.3.0",
    "vue-tsc": "^1.8.0",
    "@types/node": "^20.10.0",
    "sass": "^1.69.0",
    "unplugin-auto-import": "^0.17.0",
    "unplugin-vue-components": "^0.26.0",
    "eslint": "^8.56.0",
    "eslint-plugin-vue": "^9.19.0",
    "@typescript-eslint/eslint-plugin": "^6.15.0",
    "@typescript-eslint/parser": "^6.15.0",
    "prettier": "^3.1.0"
  }
}
```

### vite.config.ts
```typescript
import { defineConfig } from 'vite'
import vue from '@vitejs/plugin-vue'
import electron from 'vite-plugin-electron'
import electronRenderer from 'vite-plugin-electron-renderer'
import AutoImport from 'unplugin-auto-import/vite'
import Components from 'unplugin-vue-components/vite'
import { ElementPlusResolver } from 'unplugin-vue-components/resolvers'
import { resolve } from 'path'

export default defineConfig({
  plugins: [
    vue(),
    electron([
      {
        entry: 'electron/main.ts',
        vite: {
          build: {
            outDir: 'dist-electron',
            rollupOptions: {
              external: ['electron']
            }
          }
        }
      },
      {
        entry: 'electron/preload.ts',
        onstart(options) {
          options.reload()
        }
      }
    ]),
    electronRenderer(),
    AutoImport({
      imports: ['vue', 'vue-router', 'pinia'],
      resolvers: [ElementPlusResolver()],
      dts: 'src/types/auto-imports.d.ts'
    }),
    Components({
      resolvers: [ElementPlusResolver()],
      dts: 'src/types/components.d.ts'
    })
  ],
  resolve: {
    alias: {
      '@': resolve(__dirname, 'src')
    }
  },
  css: {
    preprocessorOptions: {
      scss: {
        additionalData: `@use "@/styles/variables.scss" as *;`
      }
    }
  }
})
```

### tsconfig.json
```json
{
  "compilerOptions": {
    "target": "ES2020",
    "useDefineForClassFields": true,
    "module": "ESNext",
    "lib": ["ES2020", "DOM", "DOM.Iterable"],
    "skipLibCheck": true,
    "moduleResolution": "bundler",
    "allowImportingTsExtensions": true,
    "resolveJsonModule": true,
    "isolatedModules": true,
    "noEmit": true,
    "jsx": "preserve",
    "strict": true,
    "noUnusedLocals": true,
    "noUnusedParameters": true,
    "noFallthroughCasesInSwitch": true,
    "baseUrl": ".",
    "paths": {
      "@/*": ["src/*"]
    },
    "types": ["vite/client", "node"]
  },
  "include": ["src/**/*.ts", "src/**/*.tsx", "src/**/*.vue", "electron/**/*.ts"],
  "references": [{ "path": "./tsconfig.node.json" }]
}
```

## 4. æ ¸å¿ƒä»£ç æ–‡ä»¶

### electron/main.ts
```typescript
import { app, BrowserWindow, ipcMain } from 'electron'
import { join } from 'path'

// ç¦ç”¨ç¡¬ä»¶åŠ é€Ÿï¼ˆè§£å†³æŸäº›ç³»ç»Ÿçš„å…¼å®¹æ€§é—®é¢˜ï¼‰
app.disableHardwareAcceleration()

let mainWindow: BrowserWindow | null = null

const isDev = !app.isPackaged

async function createWindow() {
  mainWindow = new BrowserWindow({
    width: 1200,
    height: 800,
    minWidth: 800,
    minHeight: 600,
    webPreferences: {
      preload: join(__dirname, 'preload.js'),
      contextIsolation: true,
      nodeIntegration: false,
      sandbox: false
    },
    show: false,
    frame: true,
    titleBarStyle: 'hiddenInset'
  })

  // ä¼˜é›…æ˜¾ç¤ºçª—å£
  mainWindow.once('ready-to-show', () => {
    mainWindow?.show()
  })

  if (isDev) {
    mainWindow.loadURL('http://localhost:5173')
    mainWindow.webContents.openDevTools()
  } else {
    mainWindow.loadFile(join(__dirname, '../dist/index.html'))
  }

  mainWindow.on('closed', () => {
    mainWindow = null
  })
}

// å•å®ä¾‹é”
const gotTheLock = app.requestSingleInstanceLock()
if (!gotTheLock) {
  app.quit()
} else {
  app.on('second-instance', () => {
    if (mainWindow) {
      if (mainWindow.isMinimized()) mainWindow.restore()
      mainWindow.focus()
    }
  })
}

app.whenReady().then(createWindow)

app.on('window-all-closed', () => {
  if (process.platform !== 'darwin') {
    app.quit()
  }
})

app.on('activate', () => {
  if (BrowserWindow.getAllWindows().length === 0) {
    createWindow()
  }
})

// IPC å¤„ç†ç¤ºä¾‹
ipcMain.handle('app:getVersion', () => app.getVersion())
```

### electron/preload.ts
```typescript
import { contextBridge, ipcRenderer } from 'electron'

// æš´éœ²å®‰å…¨çš„ API ç»™æ¸²æŸ“è¿›ç¨‹
contextBridge.exposeInMainWorld('electronAPI', {
  // åº”ç”¨ä¿¡æ¯
  getVersion: () => ipcRenderer.invoke('app:getVersion'),
  
  // çª—å£æ§åˆ¶
  minimize: () => ipcRenderer.send('window:minimize'),
  maximize: () => ipcRenderer.send('window:maximize'),
  close: () => ipcRenderer.send('window:close'),
  
  // æ–‡ä»¶æ“ä½œ
  openFile: (options?: Electron.OpenDialogOptions) => 
    ipcRenderer.invoke('dialog:openFile', options),
  saveFile: (options?: Electron.SaveDialogOptions) => 
    ipcRenderer.invoke('dialog:saveFile', options),
  
  // é€šç”¨ IPC
  invoke: (channel: string, ...args: any[]) => 
    ipcRenderer.invoke(channel, ...args),
  on: (channel: string, callback: (...args: any[]) => void) => {
    const subscription = (_event: Electron.IpcRendererEvent, ...args: any[]) => 
      callback(...args)
    ipcRenderer.on(channel, subscription)
    return () => ipcRenderer.removeListener(channel, subscription)
  }
})
```

### src/types/electron.d.ts
```typescript
export interface ElectronAPI {
  getVersion: () => Promise<string>
  minimize: () => void
  maximize: () => void
  close: () => void
  openFile: (options?: Electron.OpenDialogOptions) => Promise<string[] | undefined>
  saveFile: (options?: Electron.SaveDialogOptions) => Promise<string | undefined>
  invoke: (channel: string, ...args: any[]) => Promise<any>
  on: (channel: string, callback: (...args: any[]) => void) => () => void
}

declare global {
  interface Window {
    electronAPI: ElectronAPI
  }
}
```

### src/api/request.ts
```typescript
import axios, { type AxiosInstance, type AxiosRequestConfig, type AxiosResponse } from 'axios'
import { ElMessage } from 'element-plus'

// å“åº”æ•°æ®ç»“æ„
interface ApiResponse<T = any> {
  code: number
  message: string
  data: T
}

// åˆ›å»º axios å®ä¾‹
const service: AxiosInstance = axios.create({
  baseURL: import.meta.env.VITE_API_BASE_URL || 'http://127.0.0.1:8765',
  timeout: 30000,
  headers: {
    'Content-Type': 'application/json'
  }
})

// è¯·æ±‚æ‹¦æˆªå™¨
service.interceptors.request.use(
  (config) => {
    // å¯åœ¨æ­¤æ·»åŠ  token
    const token = localStorage.getItem('token')
    if (token) {
      config.headers.Authorization = `Bearer ${token}`
    }
    return config
  },
  (error) => {
    console.error('Request error:', error)
    return Promise.reject(error)
  }
)

// å“åº”æ‹¦æˆªå™¨
service.interceptors.response.use(
  (response: AxiosResponse<ApiResponse>) => {
    const { code, message, data } = response.data
    
    if (code === 200) {
      return data
    }
    
    // ä¸šåŠ¡é”™è¯¯
    ElMessage.error(message || 'è¯·æ±‚å¤±è´¥')
    return Promise.reject(new Error(message))
  },
  (error) => {
    // HTTP é”™è¯¯
    const message = error.response?.data?.message || error.message || 'ç½‘ç»œé”™è¯¯'
    ElMessage.error(message)
    return Promise.reject(error)
  }
)

// å°è£…è¯·æ±‚æ–¹æ³•
export const request = {
  get<T>(url: string, config?: AxiosRequestConfig): Promise<T> {
    return service.get(url, config)
  },
  post<T>(url: string, data?: any, config?: AxiosRequestConfig): Promise<T> {
    return service.post(url, data, config)
  },
  put<T>(url: string, data?: any, config?: AxiosRequestConfig): Promise<T> {
    return service.put(url, data, config)
  },
  delete<T>(url: string, config?: AxiosRequestConfig): Promise<T> {
    return service.delete(url, config)
  }
}

export default service
```

### src/stores/index.ts
```typescript
import { createPinia } from 'pinia'
import { createPersistedState } from 'pinia-plugin-persistedstate'

const pinia = createPinia()

// æŒä¹…åŒ–æ’ä»¶
pinia.use(createPersistedState({
  storage: localStorage,
  key: (id) => `__pinia_${id}__`
}))

export default pinia

// ç»Ÿä¸€å¯¼å‡ºæ‰€æœ‰ store
export * from './modules/app'
export * from './modules/user'
```

### src/stores/modules/app.ts
```typescript
import { defineStore } from 'pinia'
import { ref, computed } from 'vue'

export const useAppStore = defineStore('app', () => {
  // çŠ¶æ€
  const sidebarCollapsed = ref(false)
  const theme = ref<'light' | 'dark'>('light')
  const language = ref('zh-CN')

  // è®¡ç®—å±æ€§
  const isDark = computed(() => theme.value === 'dark')

  // æ–¹æ³•
  function toggleSidebar() {
    sidebarCollapsed.value = !sidebarCollapsed.value
  }

  function setTheme(newTheme: 'light' | 'dark') {
    theme.value = newTheme
    document.documentElement.setAttribute('data-theme', newTheme)
  }

  function setLanguage(lang: string) {
    language.value = lang
  }

  return {
    sidebarCollapsed,
    theme,
    language,
    isDark,
    toggleSidebar,
    setTheme,
    setLanguage
  }
}, {
  persist: true // å¼€å¯æŒä¹…åŒ–
})
```
```

#### 2.1.2 Python FastAPI åç«¯é¡¹ç›®
```
è¯·ç”Ÿæˆ Python FastAPI åç«¯é¡¹ç›®çš„å®Œæ•´è„šæ‰‹æ¶ã€‚

ã€é¡¹ç›®è¦æ±‚ã€‘
- é¡¹ç›®åç§°ï¼š{{project_name}}_backend
- Python ç‰ˆæœ¬ï¼š3.11+
- æ•°æ®åº“ï¼šSQLiteï¼ˆå¼€å‘ï¼‰/ PostgreSQLï¼ˆç”Ÿäº§ï¼‰
- ORMï¼šSQLAlchemy 2.0
- å‘é‡æ•°æ®åº“ï¼šLanceDB
- åŒ…ç®¡ç†ï¼špip + requirements.txt

ã€è¾“å‡ºå†…å®¹ã€‘

## 1. é¡¹ç›®ç»“æ„
```
{{project_name}}_backend/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ main.py                  # FastAPI åº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ config.py                # é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ dependencies.py          # ä¾èµ–æ³¨å…¥
â”‚   â”‚
â”‚   â”œâ”€â”€ api/                     # API è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ router.py            # è·¯ç”±èšåˆ
â”‚   â”‚   â””â”€â”€ v1/
â”‚   â”‚       â”œâ”€â”€ __init__.py
â”‚   â”‚       â”œâ”€â”€ documents.py
â”‚   â”‚       â”œâ”€â”€ knowledge.py
â”‚   â”‚       â”œâ”€â”€ generation.py
â”‚   â”‚       â””â”€â”€ health.py
â”‚   â”‚
â”‚   â”œâ”€â”€ core/                    # æ ¸å¿ƒæ¨¡å—
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ security.py          # å®‰å…¨ç›¸å…³
â”‚   â”‚   â”œâ”€â”€ exceptions.py        # è‡ªå®šä¹‰å¼‚å¸¸
â”‚   â”‚   â””â”€â”€ response.py          # ç»Ÿä¸€å“åº”
â”‚   â”‚
â”‚   â”œâ”€â”€ models/                  # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ base.py              # åŸºç±»
â”‚   â”‚   â”œâ”€â”€ document.py
â”‚   â”‚   â””â”€â”€ user.py
â”‚   â”‚
â”‚   â”œâ”€â”€ schemas/                 # Pydantic æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ base.py
â”‚   â”‚   â”œâ”€â”€ document.py
â”‚   â”‚   â””â”€â”€ generation.py
â”‚   â”‚
â”‚   â”œâ”€â”€ services/                # ä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ document_service.py
â”‚   â”‚   â”œâ”€â”€ vector_service.py
â”‚   â”‚   â”œâ”€â”€ llm_service.py
â”‚   â”‚   â””â”€â”€ generation_service.py
â”‚   â”‚
â”‚   â”œâ”€â”€ repositories/            # æ•°æ®è®¿é—®å±‚
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ base.py
â”‚   â”‚   â””â”€â”€ document_repo.py
â”‚   â”‚
â”‚   â””â”€â”€ utils/                   # å·¥å…·å‡½æ•°
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ file_utils.py
â”‚       â””â”€â”€ text_utils.py
â”‚
â”œâ”€â”€ migrations/                  # æ•°æ®åº“è¿ç§»
â”‚   â””â”€â”€ versions/
â”‚
â”œâ”€â”€ tests/                       # æµ‹è¯•
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ conftest.py
â”‚   â”œâ”€â”€ test_api/
â”‚   â””â”€â”€ test_services/
â”‚
â”œâ”€â”€ scripts/                     # è„šæœ¬
â”‚   â”œâ”€â”€ init_db.py
â”‚   â””â”€â”€ seed_data.py
â”‚
â”œâ”€â”€ data/                        # æ•°æ®ç›®å½•
â”‚   â”œâ”€â”€ vectors/                 # å‘é‡æ•°æ®
â”‚   â””â”€â”€ uploads/                 # ä¸Šä¼ æ–‡ä»¶
â”‚
â”œâ”€â”€ templates/                   # æ–‡æ¡£æ¨¡æ¿
â”‚
â”œâ”€â”€ .env.example
â”œâ”€â”€ .env
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ requirements-dev.txt
â”œâ”€â”€ pyproject.toml
â”œâ”€â”€ Dockerfile
â””â”€â”€ docker-compose.yml
```

## 2. æ ¸å¿ƒä»£ç æ–‡ä»¶

### app/main.py
```python
from contextlib import asynccontextmanager
from fastapi import FastAPI
from fastapi.middleware.cors import CORSMiddleware
from fastapi.middleware.gzip import GZipMiddleware

from app.config import settings
from app.api.router import api_router
from app.core.exceptions import register_exception_handlers
from app.dependencies import init_services, cleanup_services


@asynccontextmanager
async def lifespan(app: FastAPI):
    """åº”ç”¨ç”Ÿå‘½å‘¨æœŸç®¡ç†"""
    # å¯åŠ¨æ—¶åˆå§‹åŒ–
    await init_services()
    print(f"ğŸš€ {settings.APP_NAME} started on port {settings.PORT}")
    
    yield
    
    # å…³é—­æ—¶æ¸…ç†
    await cleanup_services()
    print("ğŸ‘‹ Application shutdown complete")


def create_app() -> FastAPI:
    """åˆ›å»º FastAPI åº”ç”¨"""
    app = FastAPI(
        title=settings.APP_NAME,
        version=settings.VERSION,
        description="æ ‡ä¹¦ç”Ÿæˆå·¥å…·åç«¯ API",
        docs_url="/docs" if settings.DEBUG else None,
        redoc_url="/redoc" if settings.DEBUG else None,
        lifespan=lifespan,
    )
    
    # ä¸­é—´ä»¶
    app.add_middleware(
        CORSMiddleware,
        allow_origins=settings.CORS_ORIGINS,
        allow_credentials=True,
        allow_methods=["*"],
        allow_headers=["*"],
    )
    app.add_middleware(GZipMiddleware, minimum_size=1000)
    
    # æ³¨å†Œå¼‚å¸¸å¤„ç†å™¨
    register_exception_handlers(app)
    
    # æ³¨å†Œè·¯ç”±
    app.include_router(api_router, prefix="/api")
    
    return app


app = create_app()


if __name__ == "__main__":
    import uvicorn
    uvicorn.run(
        "app.main:app",
        host=settings.HOST,
        port=settings.PORT,
        reload=settings.DEBUG,
        log_level="info",
    )
```

### app/config.py
```python
from functools import lru_cache
from pathlib import Path
from typing import List
from pydantic_settings import BaseSettings, SettingsConfigDict


class Settings(BaseSettings):
    """åº”ç”¨é…ç½®"""
    model_config = SettingsConfigDict(
        env_file=".env",
        env_file_encoding="utf-8",
        case_sensitive=True,
    )
    
    # åŸºç¡€é…ç½®
    APP_NAME: str = "BidGenerator"
    VERSION: str = "1.0.0"
    DEBUG: bool = True
    HOST: str = "127.0.0.1"
    PORT: int = 8765
    
    # è·¯å¾„é…ç½®
    BASE_DIR: Path = Path(__file__).resolve().parent.parent
    DATA_DIR: Path = BASE_DIR / "data"
    UPLOAD_DIR: Path = DATA_DIR / "uploads"
    VECTOR_DIR: Path = DATA_DIR / "vectors"
    TEMPLATE_DIR: Path = BASE_DIR / "templates"
    
    # CORS
    CORS_ORIGINS: List[str] = ["http://localhost:5173", "http://127.0.0.1:5173"]
    
    # æ•°æ®åº“
    DATABASE_URL: str = "sqlite+aiosqlite:///./data/app.db"
    
    # LLM é…ç½®
    LLM_API_BASE: str = "https://api.openai.com/v1"
    LLM_API_KEY: str = ""
    LLM_MODEL: str = "gpt-4o-mini"
    LLM_TEMPERATURE: float = 0.7
    LLM_MAX_TOKENS: int = 4096
    
    # å‘é‡æ¨¡å‹é…ç½®
    EMBEDDING_MODEL: str = "text-embedding-3-small"
    EMBEDDING_DIMENSION: int = 1536
    
    # æ–‡ä»¶ä¸Šä¼ é…ç½®
    MAX_UPLOAD_SIZE: int = 50 * 1024 * 1024  # 50MB
    ALLOWED_EXTENSIONS: List[str] = [".pdf", ".docx", ".doc", ".txt", ".md"]

    def __init__(self, **kwargs):
        super().__init__(**kwargs)
        # ç¡®ä¿ç›®å½•å­˜åœ¨
        self.DATA_DIR.mkdir(parents=True, exist_ok=True)
        self.UPLOAD_DIR.mkdir(parents=True, exist_ok=True)
        self.VECTOR_DIR.mkdir(parents=True, exist_ok=True)


@lru_cache
def get_settings() -> Settings:
    """è·å–é…ç½®å•ä¾‹"""
    return Settings()


settings = get_settings()
```

### app/core/response.py
```python
from typing import Any, Generic, Optional, TypeVar
from pydantic import BaseModel

T = TypeVar("T")


class ApiResponse(BaseModel, Generic[T]):
    """ç»Ÿä¸€ API å“åº”æ ¼å¼"""
    code: int = 200
    message: str = "success"
    data: Optional[T] = None
    
    @classmethod
    def success(cls, data: T = None, message: str = "success") -> "ApiResponse[T]":
        return cls(code=200, message=message, data=data)
    
    @classmethod
    def error(cls, code: int = 500, message: str = "error") -> "ApiResponse":
        return cls(code=code, message=message, data=None)


class PageResponse(BaseModel, Generic[T]):
    """åˆ†é¡µå“åº”"""
    items: list[T]
    total: int
    page: int
    page_size: int
    pages: int
```

### app/core/exceptions.py
```python
from fastapi import FastAPI, Request, status
from fastapi.responses import JSONResponse
from pydantic import ValidationError


class AppException(Exception):
    """åº”ç”¨åŸºç¡€å¼‚å¸¸"""
    def __init__(
        self,
        code: int = 500,
        message: str = "Internal Server Error",
        detail: str = None
    ):
        self.code = code
        self.message = message
        self.detail = detail


class NotFoundException(AppException):
    """èµ„æºä¸å­˜åœ¨"""
    def __init__(self, message: str = "Resource not found"):
        super().__init__(code=404, message=message)


class BadRequestException(AppException):
    """è¯·æ±‚é”™è¯¯"""
    def __init__(self, message: str = "Bad request"):
        super().__init__(code=400, message=message)


class UnauthorizedException(AppException):
    """æœªæˆæƒ"""
    def __init__(self, message: str = "Unauthorized"):
        super().__init__(code=401, message=message)


def register_exception_handlers(app: FastAPI):
    """æ³¨å†Œå…¨å±€å¼‚å¸¸å¤„ç†å™¨"""
    
    @app.exception_handler(AppException)
    async def app_exception_handler(request: Request, exc: AppException):
        return JSONResponse(
            status_code=exc.code,
            content={
                "code": exc.code,
                "message": exc.message,
                "detail": exc.detail
            }
        )
    
    @app.exception_handler(ValidationError)
    async def validation_exception_handler(request: Request, exc: ValidationError):
        return JSONResponse(
            status_code=status.HTTP_422_UNPROCESSABLE_ENTITY,
            content={
                "code": 422,
                "message": "Validation Error",
                "detail": exc.errors()
            }
        )
    
    @app.exception_handler(Exception)
    async def global_exception_handler(request: Request, exc: Exception):
        return JSONResponse(
            status_code=status.HTTP_500_INTERNAL_SERVER_ERROR,
            content={
                "code": 500,
                "message": "Internal Server Error",
                "detail": str(exc) if app.debug else None
            }
        )
```

### app/services/llm_service.py
```python
from typing import AsyncGenerator, Optional
from openai import AsyncOpenAI

from app.config import settings


class LLMService:
    """LLM æœåŠ¡å°è£…"""
    
    def __init__(self):
        self.client = AsyncOpenAI(
            api_key=settings.LLM_API_KEY,
            base_url=settings.LLM_API_BASE,
        )
        self.model = settings.LLM_MODEL
    
    async def chat(
        self,
        messages: list[dict],
        temperature: float = None,
        max_tokens: int = None,
    ) -> str:
        """åŒæ­¥èŠå¤©"""
        response = await self.client.chat.completions.create(
            model=self.model,
            messages=messages,
            temperature=temperature or settings.LLM_TEMPERATURE,
            max_tokens=max_tokens or settings.LLM_MAX_TOKENS,
        )
        return response.choices[0].message.content
    
    async def chat_stream(
        self,
        messages: list[dict],
        temperature: float = None,
    ) -> AsyncGenerator[str, None]:
        """æµå¼èŠå¤©"""
        stream = await self.client.chat.completions.create(
            model=self.model,
            messages=messages,
            temperature=temperature or settings.LLM_TEMPERATURE,
            stream=True,
        )
        
        async for chunk in stream:
            if chunk.choices[0].delta.content:
                yield chunk.choices[0].delta.content
    
    async def embedding(self, text: str) -> list[float]:
        """è·å–æ–‡æœ¬åµŒå…¥å‘é‡"""
        response = await self.client.embeddings.create(
            model=settings.EMBEDDING_MODEL,
            input=text,
        )
        return response.data[0].embedding


# å•ä¾‹
llm_service = LLMService()
```

### app/services/vector_service.py
```python
from typing import Optional
import lancedb
from lancedb.pydantic import LanceModel, Vector

from app.config import settings


class DocumentChunk(LanceModel):
    """æ–‡æ¡£ç‰‡æ®µå‘é‡æ¨¡å‹"""
    id: str
    text: str
    vector: Vector(settings.EMBEDDING_DIMENSION)
    doc_id: str
    doc_name: str
    category: str
    chunk_index: int
    metadata: dict = {}


class VectorService:
    """å‘é‡æ•°æ®åº“æœåŠ¡"""
    
    def __init__(self):
        self.db: lancedb.DBConnection = None
        self.table: lancedb.table.Table = None
    
    async def init(self):
        """åˆå§‹åŒ–å‘é‡æ•°æ®åº“"""
        self.db = lancedb.connect(str(settings.VECTOR_DIR))
        
        try:
            self.table = self.db.open_table("documents")
        except Exception:
            self.table = self.db.create_table(
                "documents",
                schema=DocumentChunk,
                mode="overwrite"
            )
    
    async def add(
        self,
        chunks: list[dict],
        vectors: list[list[float]],
        doc_id: str,
        doc_name: str,
        category: str,
    ):
        """æ·»åŠ æ–‡æ¡£å‘é‡"""
        records = []
        for i, (chunk, vector) in enumerate(zip(chunks, vectors)):
            record = DocumentChunk(
                id=f"{doc_id}_{i}",
                text=chunk["text"],
                vector=vector,
                doc_id=doc_id,
                doc_name=doc_name,
                category=category,
                chunk_index=i,
                metadata=chunk.get("metadata", {}),
            )
            records.append(record.model_dump())
        
        if records:
            self.table.add(records)
    
    async def search(
        self,
        query_vector: list[float],
        top_k: int = 5,
        category: Optional[str] = None,
    ) -> list[dict]:
        """å‘é‡æœç´¢"""
        search = self.table.search(query_vector).limit(top_k)
        
        if category:
            search = search.where(f"category = '{category}'")
        
        results = search.to_pandas()
        
        return [
            {
                "text": row["text"],
                "score": float(1 - row["_distance"]),
                "doc_id": row["doc_id"],
                "doc_name": row["doc_name"],
                "category": row["category"],
                "metadata": row["metadata"],
            }
            for _, row in results.iterrows()
        ]
    
    async def delete_by_doc(self, doc_id: str):
        """åˆ é™¤æŒ‡å®šæ–‡æ¡£çš„æ‰€æœ‰å‘é‡"""
        self.table.delete(f"doc_id = '{doc_id}'")


# å•ä¾‹
vector_service = VectorService()
```

### app/api/v1/generation.py
```python
from fastapi import APIRouter, Depends
from fastapi.responses import StreamingResponse
from pydantic import BaseModel

from app.core.response import ApiResponse
from app.services.llm_service import llm_service
from app.services.vector_service import vector_service

router = APIRouter(prefix="/generation", tags=["Generation"])


class QueryRequest(BaseModel):
    query: str
    top_k: int = 5
    category: str | None = None
    system_prompt: str | None = None


class QueryResponse(BaseModel):
    answer: str
    sources: list[dict]


@router.post("/query", response_model=ApiResponse[QueryResponse])
async def rag_query(request: QueryRequest):
    """RAG æŸ¥è¯¢æ¥å£"""
    # 1. è·å–æŸ¥è¯¢å‘é‡
    query_vector = await llm_service.embedding(request.query)
    
    # 2. å‘é‡æ£€ç´¢
    docs = await vector_service.search(
        query_vector,
        top_k=request.top_k,
        category=request.category,
    )
    
    # 3. æ„å»ºä¸Šä¸‹æ–‡
    context = "\n\n".join([
        f"ã€æ¥æº: {d['doc_name']}ã€‘\n{d['text']}"
        for d in docs
    ])
    
    # 4. ç”Ÿæˆå›ç­”
    system = request.system_prompt or "ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„æ ‡ä¹¦ç¼–å†™åŠ©æ‰‹ã€‚è¯·æ ¹æ®æä¾›çš„å‚è€ƒèµ„æ–™å›ç­”é—®é¢˜ã€‚"
    messages = [
        {"role": "system", "content": system},
        {"role": "user", "content": f"å‚è€ƒèµ„æ–™ï¼š\n{context}\n\né—®é¢˜ï¼š{request.query}"}
    ]
    
    answer = await llm_service.chat(messages)
    
    return ApiResponse.success(QueryResponse(answer=answer, sources=docs))


@router.post("/stream")
async def rag_query_stream(request: QueryRequest):
    """RAG æµå¼æŸ¥è¯¢æ¥å£"""
    
    async def event_generator():
        try:
            # è·å–å‘é‡
            query_vector = await llm_service.embedding(request.query)
            
            # æ£€ç´¢
            docs = await vector_service.search(
                query_vector,
                top_k=request.top_k,
                category=request.category,
            )
            
            # æ„å»ºä¸Šä¸‹æ–‡
            context = "\n\n".join([
                f"ã€æ¥æº: {d['doc_name']}ã€‘\n{d['text']}"
                for d in docs
            ])
            
            system = request.system_prompt or "ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„æ ‡ä¹¦ç¼–å†™åŠ©æ‰‹ã€‚"
            messages = [
                {"role": "system", "content": system},
                {"role": "user", "content": f"å‚è€ƒèµ„æ–™ï¼š\n{context}\n\né—®é¢˜ï¼š{request.query}"}
            ]
            
            # æµå¼ç”Ÿæˆ
            async for chunk in llm_service.chat_stream(messages):
                yield f"data: {chunk}\n\n"
            
            yield "data: [DONE]\n\n"
            
        except Exception as e:
            yield f"data: [ERROR] {str(e)}\n\n"
    
    return StreamingResponse(
        event_generator(),
        media_type="text/event-stream",
        headers={
            "Cache-Control": "no-cache",
            "Connection": "keep-alive",
        },
    )
```

## 3. é…ç½®æ–‡ä»¶

### requirements.txt
```
# Core
fastapi>=0.110.0
uvicorn[standard]>=0.27.0
pydantic>=2.6.0
pydantic-settings>=2.1.0

# Database
sqlalchemy[asyncio]>=2.0.0
aiosqlite>=0.19.0
alembic>=1.13.0

# Vector DB
lancedb>=0.5.0
pyarrow>=15.0.0

# LLM
openai>=1.12.0
tiktoken>=0.6.0

# Document Processing
python-docx>=1.1.0
docxtpl>=0.16.7
pypdf>=4.0.0
python-multipart>=0.0.9

# Utils
httpx>=0.26.0
python-magic>=0.4.27
aiofiles>=23.2.0
```

### requirements-dev.txt
```
-r requirements.txt

# Testing
pytest>=8.0.0
pytest-asyncio>=0.23.0
pytest-cov>=4.1.0
httpx>=0.26.0

# Code Quality
ruff>=0.2.0
black>=24.1.0
isort>=5.13.0
mypy>=1.8.0

# Development
ipython>=8.20.0
watchfiles>=0.21.0
```

### pyproject.toml
```toml
[tool.black]
line-length = 100
target-version = ["py311"]
include = '\.pyi?$'

[tool.isort]
profile = "black"
line_length = 100

[tool.ruff]
line-length = 100
select = ["E", "F", "W", "I", "N", "UP", "B"]
ignore = ["E501"]

[tool.mypy]
python_version = "3.11"
strict = true
ignore_missing_imports = true

[tool.pytest.ini_options]
asyncio_mode = "auto"
testpaths = ["tests"]
```

### .env.example
```
# App
DEBUG=true
HOST=127.0.0.1
PORT=8765

# Database
DATABASE_URL=sqlite+aiosqlite:///./data/app.db

# LLM
LLM_API_BASE=https://api.openai.com/v1
LLM_API_KEY=your-api-key-here
LLM_MODEL=gpt-4o-mini

# Embedding
EMBEDDING_MODEL=text-embedding-3-small
```
```

---

## ä¸‰ã€ç»„ä»¶å¼€å‘æç¤ºè¯

### 3.1 å‰ç«¯ç»„ä»¶å¼€å‘

#### 3.1.1 é€šç”¨ç»„ä»¶å¼€å‘
```
è¯·å¼€å‘ä¸€ä¸ªé€šç”¨çš„ {{component_name}} ç»„ä»¶ã€‚

ã€ç»„ä»¶éœ€æ±‚ã€‘
{{component_requirements}}

ã€è®¾è®¡è§„èŒƒã€‘
- éµå¾ª Vue 3 Composition API + TypeScript
- Props å¿…é¡»æœ‰å®Œæ•´çš„ç±»å‹å®šä¹‰å’Œé»˜è®¤å€¼
- Emits å¿…é¡»æœ‰ç±»å‹å®šä¹‰
- æ”¯æŒ v-modelï¼ˆå¦‚é€‚ç”¨ï¼‰
- æš´éœ²å¿…è¦çš„æ–¹æ³•ä¾›çˆ¶ç»„ä»¶è°ƒç”¨
- æ ·å¼ä½¿ç”¨ scoped + BEM å‘½å

ã€è¾“å‡ºæ ¼å¼ã€‘

## ç»„ä»¶ä»£ç 

### {{ComponentName}}.vue
```vue
<template>
  <!-- æ¨¡æ¿ -->
</template>

<script setup lang="ts">
// ç±»å‹å®šä¹‰
interface Props {
  // ...
}

interface Emits {
  // ...
}

// Props
const props = withDefaults(defineProps<Props>(), {
  // é»˜è®¤å€¼
})

// Emits
const emit = defineEmits<Emits>()

// çŠ¶æ€

// æ–¹æ³•

// æš´éœ²ç»™çˆ¶ç»„ä»¶
defineExpose({
  // ...
})
</script>

<style scoped lang="scss">
// æ ·å¼
</style>
```

### ç±»å‹å®šä¹‰ï¼ˆå¦‚éœ€è¦ï¼‰
```typescript
// types/{{component_name}}.ts
```

### ä½¿ç”¨ç¤ºä¾‹
```vue
<!-- ä½¿ç”¨ç¤ºä¾‹ -->
```
```

#### 3.1.2 æµå¼è¾“å‡ºç»„ä»¶
```
è¯·å¼€å‘ä¸€ä¸ªæ”¯æŒ SSE æµå¼è¾“å‡ºçš„æ–‡æœ¬å±•ç¤ºç»„ä»¶ã€‚

ã€åŠŸèƒ½éœ€æ±‚ã€‘
- æ¥æ”¶ SSE äº‹ä»¶æµ URL ä½œä¸ºæ•°æ®æº
- æ”¯æŒæ‰“å­—æœºæ•ˆæœé€å­—æ˜¾ç¤º
- æ”¯æŒ Markdown æ¸²æŸ“
- æ”¯æŒæš‚åœ/ç»§ç»­/åœæ­¢
- æ˜¾ç¤ºç”ŸæˆçŠ¶æ€å’Œè¿›åº¦
- æ”¯æŒå¤åˆ¶ç”Ÿæˆå†…å®¹

ã€è¾“å‡ºç»„ä»¶ã€‘

### StreamOutput.vue
```vue
<template>
  <div class="stream-output">
    <!-- çŠ¶æ€æ  -->
    <div class="stream-output__status">
      <span class="status-indicator" :class="statusClass"></span>
      <span class="status-text">{{ statusText }}</span>
    </div>
    
    <!-- å†…å®¹åŒº -->
    <div 
      ref="contentRef"
      class="stream-output__content"
      v-html="renderedContent"
    ></div>
    
    <!-- æ§åˆ¶æ  -->
    <div class="stream-output__actions">
      <el-button 
        v-if="status === 'streaming'"
        size="small" 
        @click="togglePause"
      >
        {{ isPaused ? 'ç»§ç»­' : 'æš‚åœ' }}
      </el-button>
      <el-button 
        v-if="status === 'streaming'"
        size="small" 
        type="danger"
        @click="stop"
      >
        åœæ­¢
      </el-button>
      <el-button 
        v-if="status === 'completed'"
        size="small"
        @click="copy"
      >
        å¤åˆ¶
      </el-button>
    </div>
  </div>
</template>

<script setup lang="ts">
import { ref, computed, watch, onUnmounted } from 'vue'
import { marked } from 'marked'
import { ElMessage } from 'element-plus'

type Status = 'idle' | 'streaming' | 'paused' | 'completed' | 'error'

interface Props {
  url?: string
  autoStart?: boolean
}

interface Emits {
  (e: 'start'): void
  (e: 'chunk', chunk: string): void
  (e: 'complete', content: string): void
  (e: 'error', error: Error): void
}

const props = withDefaults(defineProps<Props>(), {
  autoStart: false
})

const emit = defineEmits<Emits>()

// çŠ¶æ€
const content = ref('')
const status = ref<Status>('idle')
const isPaused = ref(false)
const contentRef = ref<HTMLElement>()

let eventSource: EventSource | null = null
let pendingChunks: string[] = []

// è®¡ç®—å±æ€§
const statusClass = computed(() => `status--${status.value}`)

const statusText = computed(() => {
  const texts: Record<Status, string> = {
    idle: 'ç­‰å¾…ä¸­',
    streaming: isPaused.value ? 'å·²æš‚åœ' : 'ç”Ÿæˆä¸­...',
    paused: 'å·²æš‚åœ',
    completed: 'ç”Ÿæˆå®Œæˆ',
    error: 'ç”Ÿæˆå¤±è´¥'
  }
  return texts[status.value]
})

const renderedContent = computed(() => {
  if (!content.value) return ''
  return marked(content.value)
})

// æ–¹æ³•
async function start(url?: string) {
  const targetUrl = url || props.url
  if (!targetUrl) {
    console.error('No URL provided')
    return
  }
  
  // é‡ç½®çŠ¶æ€
  content.value = ''
  status.value = 'streaming'
  isPaused.value = false
  pendingChunks = []
  
  emit('start')
  
  try {
    eventSource = new EventSource(targetUrl)
    
    eventSource.onmessage = (event) => {
      const data = event.data
      
      if (data === '[DONE]') {
        complete()
        return
      }
      
      if (data.startsWith('[ERROR]')) {
        handleError(new Error(data.slice(7)))
        return
      }
      
      if (isPaused.value) {
        pendingChunks.push(data)
      } else {
        appendContent(data)
      }
    }
    
    eventSource.onerror = (error) => {
      handleError(new Error('Connection error'))
    }
    
  } catch (error) {
    handleError(error as Error)
  }
}

function appendContent(chunk: string) {
  content.value += chunk
  emit('chunk', chunk)
  scrollToBottom()
}

function scrollToBottom() {
  if (contentRef.value) {
    contentRef.value.scrollTop = contentRef.value.scrollHeight
  }
}

function togglePause() {
  isPaused.value = !isPaused.value
  
  if (!isPaused.value && pendingChunks.length > 0) {
    // æ¢å¤æ—¶å¤„ç†æš‚åœæœŸé—´çš„å†…å®¹
    pendingChunks.forEach(chunk => appendContent(chunk))
    pendingChunks = []
  }
}

function stop() {
  eventSource?.close()
  eventSource = null
  status.value = 'completed'
  emit('complete', content.value)
}

function complete() {
  eventSource?.close()
  eventSource = null
  status.value = 'completed'
  emit('complete', content.value)
}

function handleError(error: Error) {
  eventSource?.close()
  eventSource = null
  status.value = 'error'
  emit('error', error)
}

async function copy() {
  try {
    await navigator.clipboard.writeText(content.value)
    ElMessage.success('å·²å¤åˆ¶åˆ°å‰ªè´´æ¿')
  } catch {
    ElMessage.error('å¤åˆ¶å¤±è´¥')
  }
}

// æ¸…ç†
onUnmounted(() => {
  eventSource?.close()
})

// æš´éœ²æ–¹æ³•
defineExpose({
  start,
  stop,
  togglePause,
  copy,
  content,
  status
})
</script>

<style scoped lang="scss">
.stream-output {
  display: flex;
  flex-direction: column;
  border: 1px solid var(--el-border-color);
  border-radius: 8px;
  overflow: hidden;
  
  &__status {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 8px 12px;
    background: var(--el-fill-color-light);
    border-bottom: 1px solid var(--el-border-color);
    
    .status-indicator {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      
      &.status--idle { background: var(--el-color-info); }
      &.status--streaming { 
        background: var(--el-color-primary);
        animation: pulse 1s infinite;
      }
      &.status--completed { background: var(--el-color-success); }
      &.status--error { background: var(--el-color-danger); }
    }
  }
  
  &__content {
    flex: 1;
    padding: 16px;
    overflow-y: auto;
    min-height: 200px;
    max-height: 500px;
    
    :deep(p) {
      margin: 0 0 1em;
      line-height: 1.6;
    }
    
    :deep(code) {
      background: var(--el-fill-color);
      padding: 2px 6px;
      border-radius: 4px;
    }
    
    :deep(pre) {
      background: var(--el-fill-color-dark);
      padding: 12px;
      border-radius: 8px;
      overflow-x: auto;
    }
  }
  
  &__actions {
    display: flex;
    gap: 8px;
    padding: 8px 12px;
    border-top: 1px solid var(--el-border-color);
  }
}

@keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
}
</style>
```
```

### 3.2 åç«¯æœåŠ¡å¼€å‘

#### 3.2.1 Service å±‚å¼€å‘è§„èŒƒ
```
è¯·å¼€å‘ {{service_name}} æœåŠ¡å±‚ã€‚

ã€ä¸šåŠ¡éœ€æ±‚ã€‘
{{business_requirements}}

ã€è®¾è®¡è§„èŒƒã€‘
- Service å±‚å¤„ç†ä¸šåŠ¡é€»è¾‘ï¼Œä¸ç›´æ¥æ“ä½œæ•°æ®åº“
- ä¾èµ–æ³¨å…¥ Repository å±‚
- æ‰€æœ‰æ–¹æ³•ä½¿ç”¨ async/await
- è¿”å›å€¼ä½¿ç”¨ Pydantic æ¨¡å‹
- å¼‚å¸¸ä½¿ç”¨è‡ªå®šä¹‰ä¸šåŠ¡å¼‚å¸¸
- å…³é”®æ“ä½œæ·»åŠ æ—¥å¿—è®°å½•

ã€è¾“å‡ºæ ¼å¼ã€‘

## Service ä»£ç 

### services/{{service_name}}_service.py
```python
import logging
from typing import Optional

from app.core.exceptions import NotFoundException, BadRequestException
from app.repositories.{{service_name}}_repo import {{ServiceName}}Repository
from app.schemas.{{service_name}} import (
    {{ServiceName}}Create,
    {{ServiceName}}Update,
    {{ServiceName}}Response,
)

logger = logging.getLogger(__name__)


class {{ServiceName}}Service:
    """{{service_description}} æœåŠ¡"""
    
    def __init__(self, repository: {{ServiceName}}Repository):
        self.repo = repository
    
    async def create(self, data: {{ServiceName}}Create) -> {{ServiceName}}Response:
        """åˆ›å»º"""
        logger.info(f"Creating {{service_name}}: {data.model_dump()}")
        
        # ä¸šåŠ¡æ ¡éªŒ
        # ...
        
        result = await self.repo.create(data)
        return {{ServiceName}}Response.model_validate(result)
    
    async def get_by_id(self, id: str) -> {{ServiceName}}Response:
        """æ ¹æ® ID è·å–"""
        result = await self.repo.get_by_id(id)
        if not result:
            raise NotFoundException(f"{{ServiceName}} not found: {id}")
        return {{ServiceName}}Response.model_validate(result)
    
    async def update(self, id: str, data: {{ServiceName}}Update) -> {{ServiceName}}Response:
        """æ›´æ–°"""
        existing = await self.repo.get_by_id(id)
        if not existing:
            raise NotFoundException(f"{{ServiceName}} not found: {id}")
        
        result = await self.repo.update(id, data)
        logger.info(f"Updated {{service_name}}: {id}")
        return {{ServiceName}}Response.model_validate(result)
    
    async def delete(self, id: str) -> bool:
        """åˆ é™¤"""
        existing = await self.repo.get_by_id(id)
        if not existing:
            raise NotFoundException(f"{{ServiceName}} not found: {id}")
        
        await self.repo.delete(id)
        logger.info(f"Deleted {{service_name}}: {id}")
        return True
    
    async def list(
        self,
        page: int = 1,
        page_size: int = 20,
        **filters
    ) -> tuple[list[{{ServiceName}}Response], int]:
        """åˆ†é¡µåˆ—è¡¨"""
        items, total = await self.repo.list(
            offset=(page - 1) * page_size,
            limit=page_size,
            **filters
        )
        return [{{ServiceName}}Response.model_validate(item) for item in items], total
```

### ä¾èµ–æ³¨å…¥é…ç½®
```python
# dependencies.py
from functools import lru_cache
from app.services.{{service_name}}_service import {{ServiceName}}Service
from app.repositories.{{service_name}}_repo import {{ServiceName}}Repository

@lru_cache
def get_{{service_name}}_service() -> {{ServiceName}}Service:
    repo = {{ServiceName}}Repository()
    return {{ServiceName}}Service(repo)
```

### å•å…ƒæµ‹è¯•
```python
# tests/test_services/test_{{service_name}}_service.py
import pytest
from unittest.mock import AsyncMock, MagicMock

from app.services.{{service_name}}_service import {{ServiceName}}Service
from app.core.exceptions import NotFoundException


@pytest.fixture
def mock_repo():
    return AsyncMock()


@pytest.fixture
def service(mock_repo):
    return {{ServiceName}}Service(repository=mock_repo)


class Test{{ServiceName}}Service:
    
    async def test_get_by_id_success(self, service, mock_repo):
        # Arrange
        mock_repo.get_by_id.return_value = {"id": "1", "name": "test"}
        
        # Act
        result = await service.get_by_id("1")
        
        # Assert
        assert result.id == "1"
        mock_repo.get_by_id.assert_called_once_with("1")
    
    async def test_get_by_id_not_found(self, service, mock_repo):
        # Arrange
        mock_repo.get_by_id.return_value = None
        
        # Act & Assert
        with pytest.raises(NotFoundException):
            await service.get_by_id("not-exist")
```
```

#### 3.2.2 API æ¥å£å¼€å‘è§„èŒƒ
```
è¯·å¼€å‘ {{resource_name}} çš„ RESTful API æ¥å£ã€‚

ã€æ¥å£éœ€æ±‚ã€‘
{{api_requirements}}

ã€è®¾è®¡è§„èŒƒã€‘
- éµå¾ª RESTful è®¾è®¡åŸåˆ™
- è·¯å¾„ä½¿ç”¨å¤æ•°åè¯
- ä½¿ç”¨æ­£ç¡®çš„ HTTP æ–¹æ³•å’ŒçŠ¶æ€ç 
- ç»Ÿä¸€ä½¿ç”¨ ApiResponse å°è£…å“åº”
- å‚æ•°éªŒè¯ä½¿ç”¨ Pydantic
- æ·»åŠ  OpenAPI æ–‡æ¡£æ³¨é‡Š

ã€è¾“å‡ºæ ¼å¼ã€‘

### api/v1/{{resource_name}}.py
```python
from fastapi import APIRouter, Depends, Query, Path, Body, status
from typing import Optional

from app.core.response import ApiResponse, PageResponse
from app.dependencies import get_{{resource_name}}_service
from app.services.{{resource_name}}_service import {{ResourceName}}Service
from app.schemas.{{resource_name}} import (
    {{ResourceName}}Create,
    {{ResourceName}}Update,
    {{ResourceName}}Response,
    {{ResourceName}}Query,
)

router = APIRouter(prefix="/{{resource_name}}s", tags=["{{ResourceName}}"])


@router.post(
    "",
    response_model=ApiResponse[{{ResourceName}}Response],
    status_code=status.HTTP_201_CREATED,
    summary="åˆ›å»º{{resource_description}}",
    description="åˆ›å»ºæ–°çš„{{resource_description}}è®°å½•"
)
async def create(
    data: {{ResourceName}}Create = Body(..., description="åˆ›å»ºæ•°æ®"),
    service: {{ResourceName}}Service = Depends(get_{{resource_name}}_service)
):
    result = await service.create(data)
    return ApiResponse.success(result, "åˆ›å»ºæˆåŠŸ")


@router.get(
    "/{id}",
    response_model=ApiResponse[{{ResourceName}}Response],
    summary="è·å–{{resource_description}}è¯¦æƒ…"
)
async def get_by_id(
    id: str = Path(..., description="{{resource_description}} ID"),
    service: {{ResourceName}}Service = Depends(get_{{resource_name}}_service)
):
    result = await service.get_by_id(id)
    return ApiResponse.success(result)


@router.get(
    "",
    response_model=ApiResponse[PageResponse[{{ResourceName}}Response]],
    summary="è·å–{{resource_description}}åˆ—è¡¨"
)
async def list(
    page: int = Query(1, ge=1, description="é¡µç "),
    page_size: int = Query(20, ge=1, le=100, description="æ¯é¡µæ•°é‡"),
    keyword: Optional[str] = Query(None, description="æœç´¢å…³é”®è¯"),
    service: {{ResourceName}}Service = Depends(get_{{resource_name}}_service)
):
    items, total = await service.list(
        page=page,
        page_size=page_size,
        keyword=keyword
    )
    
    return ApiResponse.success(PageResponse(
        items=items,
        total=total,
        page=page,
        page_size=page_size,
        pages=(total + page_size - 1) // page_size
    ))


@router.put(
    "/{id}",
    response_model=ApiResponse[{{ResourceName}}Response],
    summary="æ›´æ–°{{resource_description}}"
)
async def update(
    id: str = Path(..., description="{{resource_description}} ID"),
    data: {{ResourceName}}Update = Body(..., description="æ›´æ–°æ•°æ®"),
    service: {{ResourceName}}Service = Depends(get_{{resource_name}}_service)
):
    result = await service.update(id, data)
    return ApiResponse.success(result, "æ›´æ–°æˆåŠŸ")


@router.delete(
    "/{id}",
    response_model=ApiResponse[bool],
    summary="åˆ é™¤{{resource_description}}"
)
async def delete(
    id: str = Path(..., description="{{resource_description}} ID"),
    service: {{ResourceName}}Service = Depends(get_{{resource_name}}_service)
):
    await service.delete(id)
    return ApiResponse.success(True, "åˆ é™¤æˆåŠŸ")
```
```

---

## å››ã€æ•°æ®åº“è®¾è®¡æç¤ºè¯

### 4.1 æ•°æ®è¡¨è®¾è®¡

```
è¯·è®¾è®¡ {{åŠŸèƒ½æ¨¡å—}} çš„æ•°æ®åº“è¡¨ç»“æ„ã€‚

ã€ä¸šåŠ¡éœ€æ±‚ã€‘
{{business_requirements}}

ã€è®¾è®¡è§„èŒƒã€‘
- ä½¿ç”¨ SQLAlchemy 2.0 å£°æ˜å¼æ¨¡å‹
- ä¸»é”®ä½¿ç”¨ UUID æˆ–é›ªèŠ±ç®—æ³•
- å¿…é¡»åŒ…å« created_atã€updated_at æ—¶é—´æˆ³
- è½¯åˆ é™¤ä½¿ç”¨ deleted_at å­—æ®µ
- å¤–é”®å…³ç³»æ˜ç¡®å®šä¹‰
- ç´¢å¼•æ ¹æ®æŸ¥è¯¢åœºæ™¯è®¾è®¡

ã€è¾“å‡ºæ ¼å¼ã€‘

## 1. ER å…³ç³»å›¾ï¼ˆæ–‡å­—æè¿°ï¼‰
```
{{Entity1}} 1 ---- N {{Entity2}}
{{Entity2}} N ---- M {{Entity3}}
```

## 2. æ¨¡å‹ä»£ç 

### models/{{model_name}}.py
```python
from datetime import datetime
from typing import Optional, List
from sqlalchemy import String, Integer, Text, DateTime, ForeignKey, Index
from sqlalchemy.orm import Mapped, mapped_column, relationship

from app.models.base import Base, TimestampMixin, SoftDeleteMixin


class {{ModelName}}(Base, TimestampMixin, SoftDeleteMixin):
    """{{model_description}}"""
    
    __tablename__ = "{{table_name}}"
    
    # ä¸»é”®
    id: Mapped[str] = mapped_column(String(36), primary_key=True)
    
    # å­—æ®µ
    name: Mapped[str] = mapped_column(String(100), nullable=False, comment="åç§°")
    description: Mapped[Optional[str]] = mapped_column(Text, comment="æè¿°")
    status: Mapped[int] = mapped_column(Integer, default=1, comment="çŠ¶æ€: 1-å¯ç”¨ 0-ç¦ç”¨")
    
    # å¤–é”®
    category_id: Mapped[str] = mapped_column(
        String(36), 
        ForeignKey("categories.id"), 
        nullable=False,
        comment="åˆ†ç±»ID"
    )
    
    # å…³ç³»
    category: Mapped["Category"] = relationship(back_populates="items")
    tags: Mapped[List["Tag"]] = relationship(
        secondary="{{table_name}}_tags",
        back_populates="items"
    )
    
    # ç´¢å¼•
    __table_args__ = (
        Index("idx_{{table_name}}_category", "category_id"),
        Index("idx_{{table_name}}_status", "status"),
        Index("idx_{{table_name}}_name", "name"),
    )
    
    def __repr__(self) -> str:
        return f"<{{ModelName}}(id={self.id}, name={self.name})>"
```

### models/base.py
```python
from datetime import datetime
from typing import Optional
from sqlalchemy import DateTime, func
from sqlalchemy.orm import DeclarativeBase, Mapped, mapped_column


class Base(DeclarativeBase):
    """æ¨¡å‹åŸºç±»"""
    pass


class TimestampMixin:
    """æ—¶é—´æˆ³æ··å…¥"""
    created_at: Mapped[datetime] = mapped_column(
        DateTime,
        default=func.now(),
        comment="åˆ›å»ºæ—¶é—´"
    )
    updated_at: Mapped[datetime] = mapped_column(
        DateTime,
        default=func.now(),
        onupdate=func.now(),
        comment="æ›´æ–°æ—¶é—´"
    )


class SoftDeleteMixin:
    """è½¯åˆ é™¤æ··å…¥"""
    deleted_at: Mapped[Optional[datetime]] = mapped_column(
        DateTime,
        nullable=True,
        comment="åˆ é™¤æ—¶é—´"
    )
    
    @property
    def is_deleted(self) -> bool:
        return self.deleted_at is not None
```

## 3. è¿ç§»è„šæœ¬

### migrations/versions/xxx_create_{{table_name}}.py
```python
"""create {{table_name}} table

Revision ID: xxx
Revises: previous_revision
Create Date: {{date}}
"""
from alembic import op
import sqlalchemy as sa

revision = 'xxx'
down_revision = 'previous_revision'
branch_labels = None
depends_on = None


def upgrade() -> None:
    op.create_table(
        '{{table_name}}',
        sa.Column('id', sa.String(36), primary_key=True),
        sa.Column('name', sa.String(100), nullable=False),
        sa.Column('description', sa.Text, nullable=True),
        sa.Column('status', sa.Integer, default=1),
        sa.Column('category_id', sa.String(36), sa.ForeignKey('categories.id'), nullable=False),
        sa.Column('created_at', sa.DateTime, server_default=sa.func.now()),
        sa.Column('updated_at', sa.DateTime, server_default=sa.func.now(), onupdate=sa.func.now()),
        sa.Column('deleted_at', sa.DateTime, nullable=True),
    )
    
    op.create_index('idx_{{table_name}}_category', '{{table_name}}', ['category_id'])
    op.create_index('idx_{{table_name}}_status', '{{table_name}}', ['status'])


def downgrade() -> None:
    op.drop_table('{{table_name}}')
```
```

---

## äº”ã€å·¥ç¨‹åŒ–é…ç½®æç¤ºè¯

### 5.1 Docker é…ç½®

```
è¯·ç”Ÿæˆé¡¹ç›®çš„ Docker å®¹å™¨åŒ–é…ç½®ã€‚

ã€é¡¹ç›®ç»“æ„ã€‘
- å‰ç«¯ï¼šElectron + Vue3ï¼ˆéœ€è¦æ‰“åŒ…ä¸ºæ¡Œé¢åº”ç”¨ï¼‰
- åç«¯ï¼šPython FastAPI

ã€è¾“å‡ºé…ç½®ã€‘

### backend/Dockerfile
```dockerfile
# æ„å»ºé˜¶æ®µ
FROM python:3.11-slim as builder

WORKDIR /app

# å®‰è£…æ„å»ºä¾èµ–
RUN apt-get update && apt-get install -y --no-install-recommends \
    build-essential \
    && rm -rf /var/lib/apt/lists/*

# å®‰è£… Python ä¾èµ–
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

# è¿è¡Œé˜¶æ®µ
FROM python:3.11-slim

WORKDIR /app

# å®‰è£…è¿è¡Œæ—¶ä¾èµ–
RUN apt-get update && apt-get install -y --no-install-recommends \
    libmagic1 \
    && rm -rf /var/lib/apt/lists/* \
    && useradd -m -u 1000 appuser

# ä»æ„å»ºé˜¶æ®µå¤åˆ¶ä¾èµ–
COPY --from=builder /usr/local/lib/python3.11/site-packages /usr/local/lib/python3.11/site-packages
COPY --from=builder /usr/local/bin /usr/local/bin

# å¤åˆ¶åº”ç”¨ä»£ç 
COPY --chown=appuser:appuser . .

# åˆ›å»ºæ•°æ®ç›®å½•
RUN mkdir -p /app/data && chown -R appuser:appuser /app/data

# åˆ‡æ¢åˆ°é root ç”¨æˆ·
USER appuser

# æš´éœ²ç«¯å£
EXPOSE 8765

# å¥åº·æ£€æŸ¥
HEALTHCHECK --interval=30s --timeout=10s --start-period=5s --retries=3 \
    CMD python -c "import httpx; httpx.get('http://localhost:8765/api/health')" || exit 1

# å¯åŠ¨å‘½ä»¤
CMD ["uvicorn", "app.main:app", "--host", "0.0.0.0", "--port", "8765"]
```

### docker-compose.yml
```yaml
version: '3.8'

services:
  backend:
    build:
      context: ./backend
      dockerfile: Dockerfile
    container_name: bid-generator-backend
    ports:
      - "8765:8765"
    volumes:
      - ./backend/data:/app/data
      - ./backend/templates:/app/templates:ro
    environment:
      - DEBUG=false
      - LLM_API_KEY=${LLM_API_KEY}
      - LLM_API_BASE=${LLM_API_BASE:-https://api.openai.com/v1}
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8765/api/health"]
      interval: 30s
      timeout: 10s
      retries: 3
    networks:
      - app-network

  # å¦‚æœéœ€è¦æ•°æ®åº“
  # postgres:
  #   image: postgres:15-alpine
  #   container_name: bid-generator-db
  #   environment:
  #     POSTGRES_DB: bidgenerator
  #     POSTGRES_USER: postgres
  #     POSTGRES_PASSWORD: ${DB_PASSWORD}
  #   volumes:
  #     - postgres_data:/var/lib/postgresql/data
  #   networks:
  #     - app-network

networks:
  app-network:
    driver: bridge

volumes:
  postgres_data:
```

### docker-compose.dev.yml
```yaml
version: '3.8'

services:
  backend:
    build:
      context: ./backend
      dockerfile: Dockerfile
    container_name: bid-generator-backend-dev
    ports:
      - "8765:8765"
    volumes:
      - ./backend:/app
      - ./backend/data:/app/data
    environment:
      - DEBUG=true
      - LLM_API_KEY=${LLM_API_KEY}
    command: uvicorn app.main:app --host 0.0.0.0 --port 8765 --reload
    networks:
      - app-network

networks:
  app-network:
    driver: bridge
```

### .dockerignore
```
# Python
__pycache__/
*.py[cod]
*$py.class
*.so
.Python
venv/
.venv/
ENV/
.pytest_cache/
.mypy_cache/
.ruff_cache/
*.egg-info/
dist/
build/

# IDE
.idea/
.vscode/
*.swp
*.swo

# Git
.git/
.gitignore

# Logs
*.log
logs/

# Local
.env
.env.local
*.db

# Test
tests/
coverage/
htmlcov/
```
```

### 5.2 CI/CD é…ç½®

```
è¯·ç”Ÿæˆ GitHub Actions CI/CD é…ç½®ã€‚

ã€æµæ°´çº¿éœ€æ±‚ã€‘
- ä»£ç æ£€æŸ¥ï¼šlintã€type check
- å•å…ƒæµ‹è¯•ï¼špytest
- æ„å»ºé•œåƒï¼šDocker build
- éƒ¨ç½²ï¼šæ¨é€åˆ°å®¹å™¨ä»“åº“

ã€è¾“å‡ºé…ç½®ã€‘

### .github/workflows/ci.yml
```yaml
name: CI

on:
  push:
    branches: [main, develop]
  pull_request:
    branches: [main]

jobs:
  # ä»£ç æ£€æŸ¥
  lint:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'
          cache: 'pip'
      
      - name: Install dependencies
        run: |
          cd backend
          pip install -r requirements-dev.txt
      
      - name: Run Ruff
        run: |
          cd backend
          ruff check .
      
      - name: Run Black
        run: |
          cd backend
          black --check .
      
      - name: Run MyPy
        run: |
          cd backend
          mypy app/

  # å•å…ƒæµ‹è¯•
  test:
    runs-on: ubuntu-latest
    needs: lint
    steps:
      - uses: actions/checkout@v4
      
      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'
          cache: 'pip'
      
      - name: Install dependencies
        run: |
          cd backend
          pip install -r requirements-dev.txt
      
      - name: Run tests
        run: |
          cd backend
          pytest --cov=app --cov-report=xml
      
      - name: Upload coverage
        uses: codecov/codecov-action@v3
        with:
          files: ./backend/coverage.xml

  # å‰ç«¯æ£€æŸ¥
  frontend-lint:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Set up Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'
          cache: 'pnpm'
      
      - name: Install pnpm
        run: npm install -g pnpm
      
      - name: Install dependencies
        run: pnpm install
      
      - name: Run ESLint
        run: pnpm lint
      
      - name: Run TypeScript check
        run: pnpm vue-tsc --noEmit

  # æ„å»ºé•œåƒ
  build:
    runs-on: ubuntu-latest
    needs: [test, frontend-lint]
    if: github.ref == 'refs/heads/main'
    steps:
      - uses: actions/checkout@v4
      
      - name: Set up Docker Buildx
        uses: docker/setup-buildx-action@v3
      
      - name: Login to Container Registry
        uses: docker/login-action@v3
        with:
          registry: ${{ secrets.REGISTRY_URL }}
          username: ${{ secrets.REGISTRY_USERNAME }}
          password: ${{ secrets.REGISTRY_PASSWORD }}
      
      - name: Build and push
        uses: docker/build-push-action@v5
        with:
          context: ./backend
          push: true
          tags: |
            ${{ secrets.REGISTRY_URL }}/bid-generator:${{ github.sha }}
            ${{ secrets.REGISTRY_URL }}/bid-generator:latest
          cache-from: type=gha
          cache-to: type=gha,mode=max
```

### .github/workflows/release.yml
```yaml
name: Release

on:
  push:
    tags:
      - 'v*'

jobs:
  build-electron:
    strategy:
      matrix:
        os: [ubuntu-latest, windows-latest, macos-latest]
    runs-on: ${{ matrix.os }}
    
    steps:
      - uses: actions/checkout@v4
      
      - name: Set up Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'
      
      - name: Install pnpm
        run: npm install -g pnpm
      
      - name: Install dependencies
        run: pnpm install
      
      - name: Build Electron app
        run: pnpm build
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      
      - name: Upload artifacts
        uses: actions/upload-artifact@v4
        with:
          name: electron-${{ matrix.os }}
          path: release/**/*

  create-release:
    needs: build-electron
    runs-on: ubuntu-latest
    steps:
      - name: Download all artifacts
        uses: actions/download-artifact@v4
      
      - name: Create Release
        uses: softprops/action-gh-release@v1
        with:
          files: |
            electron-*/**/*.exe
            electron-*/**/*.dmg
            electron-*/**/*.AppImage
          draft: true
```
```

---

## å…­ã€æ€§èƒ½ä¼˜åŒ–æç¤ºè¯

### 6.1 å‰ç«¯æ€§èƒ½ä¼˜åŒ–

```
è¯·åˆ†æå¹¶ä¼˜åŒ–ä»¥ä¸‹ Vue ç»„ä»¶çš„æ€§èƒ½é—®é¢˜ã€‚

ã€ç»„ä»¶ä»£ç ã€‘
{{component_code}}

ã€æ€§èƒ½é—®é¢˜åˆ†æç»´åº¦ã€‘
1. æ¸²æŸ“æ€§èƒ½ï¼šä¸å¿…è¦çš„é‡æ¸²æŸ“ã€å¤§åˆ—è¡¨æ¸²æŸ“
2. å†…å­˜æ³„æ¼ï¼šæœªæ¸…ç†çš„å®šæ—¶å™¨ã€äº‹ä»¶ç›‘å¬
3. æ‰“åŒ…ä½“ç§¯ï¼šæœªæŒ‰éœ€å¼•å…¥ã€å¤§ä¾èµ–
4. ç½‘ç»œè¯·æ±‚ï¼šé‡å¤è¯·æ±‚ã€æœªç¼“å­˜

ã€è¾“å‡ºæ ¼å¼ã€‘

## 1. æ€§èƒ½é—®é¢˜è¯Šæ–­

| é—®é¢˜ | å½±å“ | ä½ç½® | ä¸¥é‡ç¨‹åº¦ |
|------|------|------|---------|
| ... | ... | ... | é«˜/ä¸­/ä½ |

## 2. ä¼˜åŒ–æ–¹æ¡ˆ

### 2.1 {{é—®é¢˜1}}
**é—®é¢˜æè¿°**ï¼š...
**ä¼˜åŒ–å‰ä»£ç **ï¼š
```vue
// é—®é¢˜ä»£ç 
```

**ä¼˜åŒ–åä»£ç **ï¼š
```vue
// ä¼˜åŒ–åä»£ç 
```

**ä¼˜åŒ–æ•ˆæœ**ï¼šé¢„è®¡æå‡ XX%

### 2.2 {{é—®é¢˜2}}
...

## 3. é€šç”¨æœ€ä½³å®è·µ
- ä½¿ç”¨ `v-memo` ç¼“å­˜æ˜‚è´µè®¡ç®—
- å¤§åˆ—è¡¨ä½¿ç”¨è™šæ‹Ÿæ»šåŠ¨
- å›¾ç‰‡æ‡’åŠ è½½
- ç»„ä»¶å¼‚æ­¥åŠ è½½
- ...
```

### 6.2 åç«¯æ€§èƒ½ä¼˜åŒ–

```
è¯·åˆ†æå¹¶ä¼˜åŒ–ä»¥ä¸‹ Python API çš„æ€§èƒ½é—®é¢˜ã€‚

ã€æ¥å£ä»£ç ã€‘
{{api_code}}

ã€æ€§èƒ½æŒ‡æ ‡ã€‘
- å½“å‰å“åº”æ—¶é—´ï¼š{{current_response_time}}
- ç›®æ ‡å“åº”æ—¶é—´ï¼š{{target_response_time}}
- å¹¶å‘é‡ï¼š{{concurrent_requests}}

ã€è¾“å‡ºæ ¼å¼ã€‘

## 1. æ€§èƒ½ç“¶é¢ˆåˆ†æ

### 1.1 æ•°æ®åº“å±‚é¢
- æ…¢æŸ¥è¯¢åˆ†æ
- ç´¢å¼•ä½¿ç”¨æƒ…å†µ
- N+1 é—®é¢˜æ£€æµ‹

### 1.2 åº”ç”¨å±‚é¢
- CPU å¯†é›†æ“ä½œ
- é˜»å¡ I/O æ“ä½œ
- å†…å­˜å ç”¨åˆ†æ

### 1.3 ç½‘ç»œå±‚é¢
- å¤–éƒ¨ API è°ƒç”¨
- æ•°æ®ä¼ è¾“é‡

## 2. ä¼˜åŒ–æ–¹æ¡ˆ

### 2.1 æ•°æ®åº“ä¼˜åŒ–
```python
# ä¼˜åŒ–å‰
# ä¼˜åŒ–å
```

### 2.2 ç¼“å­˜ç­–ç•¥
```python
# ç¼“å­˜å®ç°
```

### 2.3 å¼‚æ­¥ä¼˜åŒ–
```python
# å¼‚æ­¥å¤„ç†
```

## 3. ä¼˜åŒ–æ•ˆæœé¢„ä¼°
| ä¼˜åŒ–é¡¹ | é¢„æœŸæå‡ | å®ç°æˆæœ¬ |
|-------|---------|---------|
```

---

## ä¸ƒã€ä»£ç å®¡æŸ¥æç¤ºè¯

### 7.1 ä»£ç å®¡æŸ¥æ¸…å•

```
è¯·å¯¹ä»¥ä¸‹ä»£ç è¿›è¡Œå…¨é¢å®¡æŸ¥ã€‚

ã€ä»£ç è¯­è¨€ã€‘ï¼š{{language}}
ã€ä»£ç ç±»å‹ã€‘ï¼š{{code_type}} (API/ç»„ä»¶/æœåŠ¡/å·¥å…·)

ã€å¾…å®¡æŸ¥ä»£ç ã€‘
{{code_to_review}}

ã€å®¡æŸ¥ç»´åº¦ã€‘

## 1. ä»£ç è´¨é‡
- [ ] å‘½åæ˜¯å¦æ¸…æ™°ã€ç¬¦åˆè§„èŒƒ
- [ ] å‡½æ•°/æ–¹æ³•æ˜¯å¦èŒè´£å•ä¸€
- [ ] æ˜¯å¦æœ‰é‡å¤ä»£ç 
- [ ] æ³¨é‡Šæ˜¯å¦å……åˆ†ä¸”æœ‰ä»·å€¼
- [ ] ä»£ç å¤æ‚åº¦æ˜¯å¦åˆç†

## 2. å®‰å…¨æ€§
- [ ] è¾“å…¥æ˜¯å¦éªŒè¯
- [ ] SQL æ³¨å…¥é˜²æŠ¤
- [ ] XSS é˜²æŠ¤
- [ ] æ•æ„Ÿä¿¡æ¯æ˜¯å¦æš´éœ²
- [ ] æƒé™æ˜¯å¦æ­£ç¡®æ£€æŸ¥

## 3. æ€§èƒ½
- [ ] æ˜¯å¦æœ‰æ€§èƒ½éšæ‚£
- [ ] æ•°æ®åº“æŸ¥è¯¢æ˜¯å¦ä¼˜åŒ–
- [ ] æ˜¯å¦æœ‰å†…å­˜æ³„æ¼é£é™©
- [ ] æ˜¯å¦æœ‰ä¸å¿…è¦çš„è®¡ç®—

## 4. å¯ç»´æŠ¤æ€§
- [ ] é”™è¯¯å¤„ç†æ˜¯å¦å®Œå–„
- [ ] æ—¥å¿—æ˜¯å¦å……åˆ†
- [ ] æ˜¯å¦ä¾¿äºæµ‹è¯•
- [ ] æ˜¯å¦ç¬¦åˆå›¢é˜Ÿè§„èŒƒ

## 5. å…·ä½“é—®é¢˜

### é—®é¢˜ 1ï¼š{{é—®é¢˜æ ‡é¢˜}}
**ä½ç½®**ï¼šç¬¬ X è¡Œ
**é—®é¢˜**ï¼š...
**å»ºè®®**ï¼š...
**ä¿®æ”¹ç¤ºä¾‹**ï¼š
```{{language}}
// ä¿®æ”¹åçš„ä»£ç 
```

### é—®é¢˜ 2ï¼š...

## 6. æ€»ç»“
- æ€»ä½“è¯„ä»·ï¼šğŸ‘ ä¼˜ç§€ / âœ… é€šè¿‡ / âš ï¸ éœ€ä¿®æ”¹ / âŒ éœ€é‡æ„
- å¿…é¡»ä¿®æ”¹ï¼šX é¡¹
- å»ºè®®ä¿®æ”¹ï¼šX é¡¹
- äº®ç‚¹ï¼š...
```

---

## å…«ã€é—®é¢˜æ’æŸ¥æç¤ºè¯

### 8.1 Bug æ’æŸ¥

```
è¯·å¸®æˆ‘æ’æŸ¥ä»¥ä¸‹é—®é¢˜ã€‚

ã€é—®é¢˜æè¿°ã€‘
{{problem_description}}

ã€é”™è¯¯ä¿¡æ¯ã€‘
{{error_message}}

ã€ç›¸å…³ä»£ç ã€‘
{{related_code}}

ã€ç¯å¢ƒä¿¡æ¯ã€‘
- æ“ä½œç³»ç»Ÿï¼š{{os}}
- è¿è¡Œæ—¶ç‰ˆæœ¬ï¼š{{runtime_version}}
- ä¾èµ–ç‰ˆæœ¬ï¼š{{dependencies}}

ã€æ’æŸ¥æ€è·¯ã€‘

## 1. é”™è¯¯åˆ†æ
- é”™è¯¯ç±»å‹ï¼š
- å¯èƒ½åŸå› ï¼š
  1. ...
  2. ...
  3. ...

## 2. æ’æŸ¥æ­¥éª¤

### æ­¥éª¤ 1ï¼š{{step_description}}
```bash
# æ‰§è¡Œå‘½ä»¤æˆ–ä»£ç 
```
é¢„æœŸç»“æœï¼š...

### æ­¥éª¤ 2ï¼š...

## 3. è§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆ Aï¼š{{solution_a}}ï¼ˆæ¨èï¼‰
```{{language}}
// ä¿®å¤ä»£ç 
```

### æ–¹æ¡ˆ Bï¼š{{solution_b}}
```{{language}}
// å¤‡é€‰æ–¹æ¡ˆ
```

## 4. é¢„é˜²æªæ–½
- æ·»åŠ å•å…ƒæµ‹è¯•
- å¢åŠ æ—¥å¿—è®°å½•
- æ”¹è¿›é”™è¯¯å¤„ç†
```

---

## ä¹ã€ç‰ˆæœ¬è®°å½•

| ç‰ˆæœ¬ | æ—¥æœŸ | æ›´æ–°å†…å®¹ |
|------|------|---------|
| v1.0 | 2024-01-01 | åˆå§‹ç‰ˆæœ¬ï¼Œå…¨æ ˆå¼€å‘æç¤ºè¯ä½“ç³» |
| v1.1 | 2024-03-01 | å¢åŠ ç»„ä»¶å¼€å‘æ¨¡æ¿ |
| v1.2 | 2024-05-01 | å¢åŠ æ€§èƒ½ä¼˜åŒ–å’Œä»£ç å®¡æŸ¥ |